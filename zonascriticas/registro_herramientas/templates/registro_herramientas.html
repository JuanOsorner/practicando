{% extends 'home.html' %}
{% load static %}

{% block title %}Registro de Herramientas{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'registro_herramientas/css/tools.css' %}">
{% endblock %}

{% block content_user %}
<div class="tools-container" id="tools-app"
     data-url-inventario="{% url 'api_inventario' %}"
     data-url-crear="{% url 'api_crear_inventario' %}"
     data-url-registrar="{% url 'api_registrar_ingreso' %}"
     data-url-finalizar="{% url 'api_finalizar_registro' %}"
     data-url-dashboard="{% url 'dashboard' %}">

    <header class="tools-header">
        <h2>Registro de Equipos</h2>
        <p>Selecciona los elementos que ingresas hoy.</p>
    </header>

    <div class="main-search-bar">
        <i class="fas fa-search"></i>
        <input type="text" id="main-search-input" placeholder="Buscar en equipos ingresados...">
    </div>

    <div class="tabs-container">
        <button class="tab-btn active" data-category="todos">
            <i class="fas fa-layer-group"></i> Todos
        </button>
        <button class="tab-btn" data-category="herramientas">
            <i class="fas fa-tools"></i> Herramientas
        </button>
        <button class="tab-btn" data-category="computo">
            <i class="fas fa-laptop"></i> CÃ³mputo
        </button>
    </div>

    <div id="inventory-list" class="inventory-grid">
        <div class="loading-state">Cargando...</div>
    </div>

    <button class="fab-add" id="btn-open-new-modal" title="Agregar nueva herramienta">
        <i class="fas fa-plus"></i>
    </button>

    <div class="floating-footer">
        <button id="btn-finish" class="btn-finish-floating">
            Finalizar Ingreso (<span id="counter-text">0</span>)
        </button>
    </div>

</div>
{% endblock %}

{% block extras %}
    <div id="modal-camera" class="modal-overlay hidden">
        <div class="modal-content camera-content">
            <h3>Evidencia de Ingreso</h3>
            <div class="camera-viewport">
                <video id="camera-video" autoplay playsinline></video>
                <img id="camera-preview" class="hidden">
            </div>
            <input type="file" id="evidence-file-input" accept="image/*" style="display:none;">
            <div class="input-group">
                <input type="text" id="entry-observaciones" placeholder="Observaciones (opcional)" class="styled-input-dark">
            </div>
            <div class="camera-controls">
                <button id="btn-gallery" class="btn-secondary-icon"><i class="fas fa-image"></i></button>
                <button id="btn-capture" class="btn-camera-action"><i class="fas fa-circle"></i></button>
                <div id="post-capture-actions" class="hidden" style="display: flex; gap: 15px;">
                    <button id="btn-retry" class="btn-secondary"><i class="fas fa-redo"></i></button>
                    <button id="btn-confirm-entry" class="btn-primary"><i class="fas fa-check"></i> Guardar</button>
                </div>
            </div>
            <button class="btn-close-top" data-close="modal-camera"><i class="fas fa-times"></i></button>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script type="module" src="{% static 'registro_herramientas/js/tools_controller.js' %}"></script>
{% endblock %}